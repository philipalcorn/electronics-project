Version 4
SHEET 1 3484 1604
WIRE 464 -16 400 -16
WIRE 848 -16 560 -16
WIRE 960 -16 848 -16
WIRE 1072 -16 960 -16
WIRE 400 16 400 -16
WIRE 560 32 560 -16
WIRE 464 48 464 -16
WIRE 512 48 464 48
WIRE -32 96 -128 96
WIRE 128 96 -32 96
WIRE 272 96 192 96
WIRE 464 96 352 96
WIRE 512 96 464 96
WIRE -128 160 -128 96
WIRE 560 160 560 112
WIRE -128 304 -128 240
WIRE 464 336 464 96
WIRE 576 336 464 336
WIRE 720 336 640 336
WIRE 848 336 848 -16
WIRE 848 336 800 336
WIRE 464 512 464 336
WIRE 576 512 464 512
WIRE 720 512 640 512
WIRE 848 512 848 336
WIRE 848 512 800 512
WIRE 464 672 464 512
WIRE 576 672 464 672
WIRE 720 672 640 672
WIRE 848 672 848 512
WIRE 848 672 800 672
WIRE 464 848 464 672
WIRE 576 848 464 848
WIRE 720 848 640 848
WIRE 848 848 848 672
WIRE 848 848 800 848
WIRE 464 1024 464 848
WIRE 624 1024 464 1024
WIRE 848 1024 848 848
WIRE 848 1024 704 1024
FLAG 560 160 0
FLAG -128 304 0
FLAG 400 16 0
FLAG 960 -16 vout
FLAG -32 96 vin
SYMBOL e 560 16 R0
SYMATTR InstName E1
SYMATTR Value 100Meg
SYMBOL cap 192 80 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value ""
SYMBOL res 368 80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value ""
SYMBOL cap 640 320 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value ""
SYMBOL res 816 320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value ""
SYMBOL cap 640 496 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value ""
SYMBOL res 816 496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value ""
SYMBOL cap 640 656 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value ""
SYMBOL res 816 656 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value ""
SYMBOL res 720 1008 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value ""
SYMBOL voltage -128 144 R0
WINDOW 3 24 152 Left 2
WINDOW 123 24 124 Left 2
SYMATTR Value 0
SYMATTR Value2 AC 1 0
SYMATTR InstName V1
SYMBOL cap 640 832 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C5
SYMATTR Value ""
SYMBOL res 816 832 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value ""
TEXT 1936 24 Left 2 !.ac dec 1000 20 20k
TEXT 2488 440 Left 2 ;These traces on a dB scale will probably be useful; focus on the magnitude \nresponse and assume that the phase response is not important for the \ntarget application space of this project:\n \n1) pink noise shaping filter design magnitude response\nV(vout)\n \n2) ideal magnitude response\nG*frequency^-0.5\n \nG is a gain parameter that you can set to whatever value gets your two plots\nabove to overlap well; your main goal here should be to get the slope of your\noutput magnitude to be "close enough" to the ideal pink noise filter rolloff of\n10*log10(1/2) dB/octave, which is about -3.0103 dB/octave (recall that an \noctave is a factor of 2)\n \nDon't spend too much time, if any, on picking the "right" value of G; your best\nbet is to export the V(vout) ac data to Matlab/Python and perform linear\nleast-squares (LS) estimation on the slope of the magnitude response of your \nfilter; do the LS fitting with dB for the vout magnitude values versus the log10 \nof the frequencies; the estimated slope should be "very close" to the ideal \nslope of pink noise (in dB/octave) over the frequency range of interest, i.e., \nthe audio band, [20 Hz, 20 kHz]\n \nIn addition to optimizing the slope of the pink noise shaping filter magnitude \nresponse (see above), your design should also minimize the maximum error; \nthat is, the maximum absolute difference between your linear least-squares fit \nand the simulated magnitude response should be minimized over the audio \nband; you should also assess this in Matlab/Python
TEXT -736 -528 Left 2 ;PINK NOISE SHAPING FILTER
TEXT 1936 88 Left 2 !.options plotwinsize=0 numdgt=15 measdgt=15
TEXT 488 -128 Left 2 ;ideal\nopamp\nmodel
TEXT -688 544 Left 2 ;Where to start?\n \nIf you choose this filter architecture, then you will\ndesign numerical values for all 11 components! \n \nThat is, all caps:\nC1, C2, C3, C4, C5,\nand all resistors:\nR1, R2, R3, R4, R5, R6.\n \nSince this circuit will be implemented as a discrete\ncircuit and not on an integrated circuit (IC) chip, you\nwill need to find feasible, discrete component\nvalues for the various passive components; if you\nneed a nonstandard component value, consider\nconstructing what you need from series and/or \nparallel combinations of standard values\n \nSee the note to the right about ways to improve\nthis circuit; i.e., adding more feedback shelves,\nand/or adding a feedback capacitor; if you make\nany additions to this circuit, then you will obviously\nneed to design values for any additional components
TEXT 1208 440 Left 2 ;other considerations:\n-there are other, similar pink noise shaping filters; this is an \n  idea to get you started\n \n-you'll probably want to investigate adding some additional \n  components for improving the performance (see below)\n \n-each RC "shelf" is designed to activate at a certain frequency\n \n-this architecture has 4 feedback RC shelves and a feedback \n  resistor (and a source RC shelf with R1 and C1)\n \n-additional feedback RC shelves can be added (e.g., 6 instead \n  of 4), and a feedback cap in parallel with the feedback resistor\n  can also be added; you need to decide what is best\n \n-note that the pink noise shaping filter output will drive a series \n  cap followed by a potentiometer in the overall design of your \n  pink noise generator system (not shown here, not needed here)\n \n-the input to this filter will come from the output of a gain stage\n  (not shown here, not needed here)\n \n-the gain stage will receive its input from an NPN BJT in what\n  is known as open-collector configuration (not shown here, not\n  needed here)\n \n-the BJT circuit will provide "white" (a.k.a. gaussian) noise; this\n  white noise will be faily low in amplitude, which is what \n  necessitates a gain stage\n \n-the ideal opamp in this schematic is good enough to start\n  the design of the passive components, but you should also\n  investigate practical opamps and decide which ones will work \n  best for your circuit; you will need at least two opamps for\n  your overall implementation: one for the pink noise shaping\n  filter, and one for the gain stage mentioned above; consider\n  getting an IC chip that has multiple opamps on it (and get \n  some spares in case something goes wrong)\n \n-this testbench is an AC testbench; no DC considerations will be\n  taken into account here (you'll eventually need to consider them)
TEXT -664 176 Left 2 ;in the overall system, this input will\ncome from a gain stage of some kind\n(to be deternined by you)
TEXT 1072 -152 Left 2 ;in the overall system, this output will\nconnect to a cap and a potentiometer\n(to be determined by you)
TEXT 280 1136 Left 2 ;you need to think about ways to improve this circuit!\nas it is currently shown, it may not be sufficient!
